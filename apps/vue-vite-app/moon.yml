type: 'application'

workspace:
  inheritedTasks:
    exclude: ['buildPackage', 'test', 'typecheck']

fileGroups:
  vite:
    - 'src/**/*'
    - 'env.d.ts'
    - 'index.html'
    - 'vite.config.*'
    - 'package.json'

tasks:
  dev:
    command: 'vite'
    args: 'dev'
    inputs:
      - '@group(vite)'
    options:
      runInCI: false

  build:
    command: 'vite'
    args: 'build'
    inputs:
      - '@group(vite)'
    outputs:
      - 'dist'

  preview:
    command: 'vite'
    args: 'preview --port 4173'
    inputs:
      - '@group(vite)'
    deps:
      - '~:build'
    options:
      runInCI: false

  test:
    command: 'vitest'
    args:
      - 'run'
      - '--environment'
      - 'jsdom'
      - '--coverage'
      - '--passWithNoTests'
    inputs:
      - '@group(vite)'
      - 'tests/**/*'
      - 'vitest.config.*'

  typecheck:
    command: 'vue-tsc'
    args:
      - '--noEmit'
      - '--project'
      - 'tsconfig.vitest.json'
      - '--composite'
      - 'false'
    inputs:
      - '@group(vite)'
      - 'tests/**/*'
      - 'tsconfig.json'
      - 'tsconfig.*.json'

  # Extends the top-level lint
  lint:
    args:
      - '--ext'
      - '.js,.ts,.vue'
