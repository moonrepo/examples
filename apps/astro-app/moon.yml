type: 'application'

workspace:
  inheritedTasks:
    exclude: ['buildPackage']

fileGroups:
  astro:
    - 'src/**/*'
    - 'astro.config.*'
    - 'package.json'

tasks:
  astro:
    command: 'astro'
    local: true

  dev:
    command: 'astro dev'
    deps:
      - '^:build'
    inputs:
      - '@group(astro)'
    local: true

  build:
    command: 'astro build'
    deps:
      - '^:build'
    inputs:
      - '@group(astro)'
    outputs:
      - 'dist'

  check:
    command: 'astro check'
    inputs:
      - '@group(astro)'
    deps:
      - '~:typecheck'

  preview:
    command: 'astro preview'
    inputs:
      - '@group(astro)'
    deps:
      - '~:build'
    local: true

  # Extends the top-level lint
  lint:
    args:
      - '--ext'
      - '.ts,.tsx,.astro'
